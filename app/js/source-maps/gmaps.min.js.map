{"version":3,"sources":["gmaps.js"],"names":["root","factory","exports","module","define","amd","GMaps","this","extend_object","obj","new_obj","name","undefined","array_map","array","callback","i","original_callback_params","Array","prototype","slice","call","arguments","array_return","array_length","length","map","item","callback_params","splice","apply","push","array_flat","new_array","concat","coordsToLatLngs","coords","useGeoJSON","first_coord","second_coord","google","maps","LatLng","arrayToLatLng","getElementsByClassName","class_name","context","_class","replace","$","document","getElementById","id","window","findAbsolutePosition","curleft","curtop","getBoundingClientRect","rect","sx","scrollX","pageXOffset","sy","scrollY","pageYOffset","left","top","offsetParent","offsetLeft","offsetTop","global","doc","options","console","error","zoom","mapType","valueOrDefault","value","defaultValue","self","events_that_hide_context_menu","events_that_doesnt_hide_context_menu","options_to_be_deleted","identifier","el","div","markerClustererFunction","markerClusterer","MapTypeId","toUpperCase","map_center","lat","lng","zoomControl","zoomControlOpt","style","position","zoomControlStyle","zoomControlPosition","panControl","mapTypeControl","scaleControl","streetViewControl","overviewMapControl","map_options","map_base_options","center","mapTypeId","map_controls_options","zoomControlOptions","ZoomControlStyle","ControlPosition","indexOf","context_menu","controls","overlays","layers","singleLayers","markers","polylines","routes","polygons","infoWindow","overlay_el","registered_events","width","scrollWidth","offsetWidth","height","scrollHeight","offsetHeight","visualRefresh","enableNewStyle","disableDefaultUI","Map","buildContextMenuHTML","control","e","html","hasOwnProperty","option","title","context_menu_element","innerHTML","context_menu_items","getElementsByTagName","context_menu_items_count","context_menu_item","event","clearListeners","addDomListenerOnce","ev","preventDefault","action","hideContextMenu","pixel","x","y","buildContextMenu","overlay","OverlayView","setMap","draw","projection","getProjection","marker","getPosition","fromLatLngToContainerPixel","setTimeout","display","setContextMenu","ul","createElement","minWidth","background","listStyle","padding","boxShadow","body","appendChild","addDomListener","relatedTarget","contains","setupListener","object","addListener","rightclick","refresh","trigger","fitZoom","latLngs","markers_length","visible","fitLatLngBounds","total","bounds","LatLngBounds","extend","fitBounds","setCenter","panTo","getElement","zoomIn","getZoom","setZoom","zoomOut","method","native_methods","gmaps","scope","method_name","createControl","cursor","disableDefaultStyles","fontFamily","fontSize","classes","className","content","HTMLElement","events","index","addControl","removeControl","controlsForPosition","getAt","removeAt","createMarker","details","fences","outside","base_options","marker_options","Marker","InfoWindow","info_window_events","marker_events","marker_events_with_mouse","me","fromLatLngToPoint","latLng","click","hideInfoWindows","open","checkMarkerGeofence","m","f","addMarker","fire","addMarkers","close","removeMarker","removeMarkers","collection","new_markers","clearMarkers","getMap","drawOverlay","auto_show","onAdd","borderStyle","borderWidth","zIndex","layer","panes","getPanes","stop_overlay_events","navigator","userAgent","toLowerCase","all","cancelBubble","returnValue","stopPropagation","overlayMouseTarget","fromLatLngToDivPixel","horizontalOffset","verticalOffset","children","content_height","clientHeight","content_width","clientWidth","verticalAlign","horizontalAlign","show","onRemove","remove","parentNode","removeChild","removeOverlay","removeOverlays","drawPolyline","path","points","latlng","polyline_options","strokeColor","strokeOpacity","strokeWeight","geodesic","clickable","editable","icons","polyline","Polyline","polyline_events","removePolyline","removePolylines","drawCircle","polygon","Circle","polygon_events","drawRectangle","latLngBounds","Rectangle","drawPolygon","paths","Polygon","removePolygon","removePolygons","getFromFusionTables","fusion_tables_options","FusionTablesLayer","loadFromFusionTables","getFromKML","url","kml_options","KmlLayer","loadFromKML","addLayer","layerName","weather","WeatherLayer","clouds","CloudLayer","traffic","TrafficLayer","transit","TransitLayer","bicycling","BicyclingLayer","panoramio","PanoramioLayer","setTag","filter","places","PlacesService","search","nearbySearch","radarSearch","placeSearchRequest","keyword","location","radius","rankBy","types","textSearch","textSearchRequest","query","setOptions","removeLayer","travelMode","unitSystem","getRoutes","TravelMode","BICYCLING","TRANSIT","DRIVING","WALKING","UnitSystem","IMPERIAL","METRIC","request_options","avoidHighways","avoidTolls","optimizeWaypoints","waypoints","origin","test","destination","DirectionsService","route","result","status","DirectionsStatus","OK","r","removeRoutes","getElevations","locations","samples","service","ElevationService","pathRequest","getElevationAlongPath","getElevationForLocations","cleanRoute","renderRoute","renderOptions","panel","DirectionsRenderer","response","setDirections","drawRoute","overview_path","travelRoute","start","step","legs","steps","step_number","end","drawSteppedRoute","Route","step_count","steps_length","MVCArray","getPath","getRoute","back","p","pop","forward","checkGeofence","fence","containsLatLng","outside_callback","pos","toImage","static_map_options","getCenter","geometry","encoding","encodePath","staticMapURL","parseColor","color","opacity","parseFloat","Math","min","max","toString","data","parameters","static_root","protocol","styles","address","join","encodeURI","size","sensor","param","loc","icon","label","styleRule","featureType","elementType","j","stylers","ruleArg","substring","rule","parseInt","fillColor","fillcolor","fillOpacity","dpi","devicePixelRatio","addMapType","tileSize","Size","ImageMapType","mapTypes","set","addOverlayMapType","overlayMapTypeIndex","overlayMapTypes","insertAt","removeOverlayMapType","addStyle","styledMapType","StyledMapType","styledMapName","setStyle","setMapTypeId","createPanorama","streetview_options","panorama","setStreetView","streetview_events","StreetViewPanorama","on","event_name","handler","off","once","custom_events","registered_event","eventName","addListenerOnce","firing_events","geolocate","complete_callback","always","complete","geolocation","getCurrentPosition","success","not_supported","geocode","geocoder","Geocoder","results","getBounds","getPaths","getLength","inPoly","numPaths","numPoints","vertex1","vertex2","spherical","computeDistanceBetween","getRadius","setFences","addFence","getId","searchElement","TypeError","t","Object","len","n","Number","Infinity","floor","abs","k"],"mappings":"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","file":"../gmaps.min.js","sourcesContent":["\"use strict\";\r\n(function(root, factory) {\r\n  if(typeof exports === 'object') {\r\n    module.exports = factory();\r\n  }\r\n  else if(typeof define === 'function' && define.amd) {\r\n    define(['jquery', 'googlemaps!'], factory);\r\n  }\r\n  else {\r\n    root.GMaps = factory();\r\n  }\r\n\r\n\r\n}(this, function() {\r\n\r\n/*!\r\n * GMaps.js v0.4.25\r\n * http://hpneo.github.com/gmaps/\r\n *\r\n * Copyright 2017, Gustavo Leon\r\n * Released under the MIT License.\r\n */\r\n\r\nvar extend_object = function(obj, new_obj) {\r\n  var name;\r\n\r\n  if (obj === new_obj) {\r\n    return obj;\r\n  }\r\n\r\n  for (name in new_obj) {\r\n    if (new_obj[name] !== undefined) {\r\n      obj[name] = new_obj[name];\r\n    }\r\n  }\r\n\r\n  return obj;\r\n};\r\n\r\nvar replace_object = function(obj, replace) {\r\n  var name;\r\n\r\n  if (obj === replace) {\r\n    return obj;\r\n  }\r\n\r\n  for (name in replace) {\r\n    if (obj[name] != undefined) {\r\n      obj[name] = replace[name];\r\n    }\r\n  }\r\n\r\n  return obj;\r\n};\r\n\r\nvar array_map = function(array, callback) {\r\n  var original_callback_params = Array.prototype.slice.call(arguments, 2),\r\n      array_return = [],\r\n      array_length = array.length,\r\n      i;\r\n\r\n  if (Array.prototype.map && array.map === Array.prototype.map) {\r\n    array_return = Array.prototype.map.call(array, function(item) {\r\n      var callback_params = original_callback_params.slice(0);\r\n      callback_params.splice(0, 0, item);\r\n\r\n      return callback.apply(this, callback_params);\r\n    });\r\n  }\r\n  else {\r\n    for (i = 0; i < array_length; i++) {\r\n      callback_params = original_callback_params;\r\n      callback_params.splice(0, 0, array[i]);\r\n      array_return.push(callback.apply(this, callback_params));\r\n    }\r\n  }\r\n\r\n  return array_return;\r\n};\r\n\r\nvar array_flat = function(array) {\r\n  var new_array = [],\r\n      i;\r\n\r\n  for (i = 0; i < array.length; i++) {\r\n    new_array = new_array.concat(array[i]);\r\n  }\r\n\r\n  return new_array;\r\n};\r\n\r\nvar coordsToLatLngs = function(coords, useGeoJSON) {\r\n  var first_coord = coords[0],\r\n      second_coord = coords[1];\r\n\r\n  if (useGeoJSON) {\r\n    first_coord = coords[1];\r\n    second_coord = coords[0];\r\n  }\r\n\r\n  return new google.maps.LatLng(first_coord, second_coord);\r\n};\r\n\r\nvar arrayToLatLng = function(coords, useGeoJSON) {\r\n  var i;\r\n\r\n  for (i = 0; i < coords.length; i++) {\r\n    if (!(coords[i] instanceof google.maps.LatLng)) {\r\n      if (coords[i].length > 0 && typeof(coords[i][0]) === \"object\") {\r\n        coords[i] = arrayToLatLng(coords[i], useGeoJSON);\r\n      }\r\n      else {\r\n        coords[i] = coordsToLatLngs(coords[i], useGeoJSON);\r\n      }\r\n    }\r\n  }\r\n\r\n  return coords;\r\n};\r\n\r\nvar getElementsByClassName = function (class_name, context) {\r\n    var element,\r\n        _class = class_name.replace('.', '');\r\n\r\n    if ('jQuery' in this && context) {\r\n        element = $(\".\" + _class, context)[0];\r\n    } else {\r\n        element = document.getElementsByClassName(_class)[0];\r\n    }\r\n    return element;\r\n\r\n};\r\n\r\nvar getElementById = function(id, context) {\r\n  var element,\r\n  id = id.replace('#', '');\r\n\r\n  if ('jQuery' in window && context) {\r\n    element = $('#' + id, context)[0];\r\n  } else {\r\n    element = document.getElementById(id);\r\n  };\r\n\r\n  return element;\r\n};\r\n\r\nvar findAbsolutePosition = function(obj)  {\r\n  var curleft = 0,\r\n      curtop = 0;\r\n\r\n  if (obj.getBoundingClientRect) {\r\n      var rect = obj.getBoundingClientRect();\r\n      var sx = -(window.scrollX ? window.scrollX : window.pageXOffset);\r\n      var sy = -(window.scrollY ? window.scrollY : window.pageYOffset);\r\n\r\n      return [(rect.left - sx), (rect.top - sy)];\r\n  }\r\n\r\n  if (obj.offsetParent) {\r\n    do {\r\n      curleft += obj.offsetLeft;\r\n      curtop += obj.offsetTop;\r\n    } while (obj = obj.offsetParent);\r\n  }\r\n\r\n  return [curleft, curtop];\r\n};\r\n\r\nvar GMaps = (function(global) {\r\n  \"use strict\";\r\n\r\n  var doc = document;\r\n  /**\r\n   * Creates a new GMaps instance, including a Google Maps map.\r\n   * @class GMaps\r\n   * @constructs\r\n   * @param {object} options - `options` accepts all the [MapOptions](https://developers.google.com/maps/documentation/javascript/reference#MapOptions) and [events](https://developers.google.com/maps/documentation/javascript/reference#Map) listed in the Google Maps API. Also accepts:\r\n   * * `lat` (number): Latitude of the map's center\r\n   * * `lng` (number): Longitude of the map's center\r\n   * * `el` (string or HTMLElement): container where the map will be rendered\r\n   * * `markerClusterer` (function): A function to create a marker cluster. You can use MarkerClusterer or MarkerClustererPlus.\r\n   */\r\n  var GMaps = function(options) {\r\n\r\n    if (!(typeof window.google === 'object' && window.google.maps)) {\r\n      if (typeof window.console === 'object' && window.console.error) {\r\n        console.error('Google Maps API is required. Please register the following JavaScript library https://maps.googleapis.com/maps/api/js.');\r\n      }\r\n\r\n      return function() {};\r\n    }\r\n\r\n    if (!this) return new GMaps(options);\r\n\r\n    options.zoom = options.zoom || 15;\r\n    options.mapType = options.mapType || 'roadmap';\r\n\r\n    var valueOrDefault = function(value, defaultValue) {\r\n      return value === undefined ? defaultValue : value;\r\n    };\r\n\r\n    var self = this,\r\n        i,\r\n        events_that_hide_context_menu = [\r\n          'bounds_changed', 'center_changed', 'click', 'dblclick', 'drag',\r\n          'dragend', 'dragstart', 'idle', 'maptypeid_changed', 'projection_changed',\r\n          'resize', 'tilesloaded', 'zoom_changed'\r\n        ],\r\n        events_that_doesnt_hide_context_menu = ['mousemove', 'mouseout', 'mouseover'],\r\n        options_to_be_deleted = ['el', 'lat', 'lng', 'mapType', 'width', 'height', 'markerClusterer', 'enableNewStyle'],\r\n        identifier = options.el || options.div,\r\n        markerClustererFunction = options.markerClusterer,\r\n        mapType = google.maps.MapTypeId[options.mapType.toUpperCase()],\r\n        map_center = new google.maps.LatLng(options.lat, options.lng),\r\n        zoomControl = valueOrDefault(options.zoomControl, true),\r\n        zoomControlOpt = options.zoomControlOpt || {\r\n          style: 'DEFAULT',\r\n          position: 'TOP_LEFT'\r\n        },\r\n        zoomControlStyle = zoomControlOpt.style || 'DEFAULT',\r\n        zoomControlPosition = zoomControlOpt.position || 'TOP_LEFT',\r\n        panControl = valueOrDefault(options.panControl, true),\r\n        mapTypeControl = valueOrDefault(options.mapTypeControl, true),\r\n        scaleControl = valueOrDefault(options.scaleControl, true),\r\n        streetViewControl = valueOrDefault(options.streetViewControl, true),\r\n        overviewMapControl = valueOrDefault(overviewMapControl, true),\r\n        map_options = {},\r\n        map_base_options = {\r\n          zoom: this.zoom,\r\n          center: map_center,\r\n          mapTypeId: mapType\r\n        },\r\n        map_controls_options = {\r\n          panControl: panControl,\r\n          zoomControl: zoomControl,\r\n          zoomControlOptions: {\r\n            style: google.maps.ZoomControlStyle[zoomControlStyle],\r\n            position: google.maps.ControlPosition[zoomControlPosition]\r\n          },\r\n          mapTypeControl: mapTypeControl,\r\n          scaleControl: scaleControl,\r\n          streetViewControl: streetViewControl,\r\n          overviewMapControl: overviewMapControl\r\n        };\r\n\r\n      if (typeof(options.el) === 'string' || typeof(options.div) === 'string') {\r\n        if (identifier.indexOf(\"#\") > -1) {\r\n            /**\r\n             * Container element\r\n             *\r\n             * @type {HTMLElement}\r\n             */\r\n            this.el = getElementById(identifier, options.context);\r\n        } else {\r\n            this.el = getElementsByClassName.apply(this, [identifier, options.context]);\r\n        }\r\n      } else {\r\n          this.el = identifier;\r\n      }\r\n\r\n    if (typeof(this.el) === 'undefined' || this.el === null) {\r\n      throw 'No element defined.';\r\n    }\r\n\r\n    window.context_menu = window.context_menu || {};\r\n    window.context_menu[self.el.id] = {};\r\n\r\n    /**\r\n     * Collection of custom controls in the map UI\r\n     *\r\n     * @type {array}\r\n     */\r\n    this.controls = [];\r\n    /**\r\n     * Collection of map's overlays\r\n     *\r\n     * @type {array}\r\n     */\r\n    this.overlays = [];\r\n    /**\r\n     * Collection of KML/GeoRSS and FusionTable layers\r\n     *\r\n     * @type {array}\r\n     */\r\n    this.layers = [];\r\n    /**\r\n     * Collection of data layers (See {@link GMaps#addLayer})\r\n     *\r\n     * @type {object}\r\n     */\r\n    this.singleLayers = {};\r\n    /**\r\n     * Collection of map's markers\r\n     *\r\n     * @type {array}\r\n     */\r\n    this.markers = [];\r\n    /**\r\n     * Collection of map's lines\r\n     *\r\n     * @type {array}\r\n     */\r\n    this.polylines = [];\r\n    /**\r\n     * Collection of map's routes requested by {@link GMaps#getRoutes}, {@link GMaps#renderRoute}, {@link GMaps#drawRoute}, {@link GMaps#travelRoute} or {@link GMaps#drawSteppedRoute}\r\n     *\r\n     * @type {array}\r\n     */\r\n    this.routes = [];\r\n    /**\r\n     * Collection of map's polygons\r\n     *\r\n     * @type {array}\r\n     */\r\n    this.polygons = [];\r\n    this.infoWindow = null;\r\n    this.overlay_el = null;\r\n    /**\r\n     * Current map's zoom\r\n     *\r\n     * @type {number}\r\n     */\r\n    this.zoom = options.zoom;\r\n    this.registered_events = {};\r\n\r\n    this.el.style.width = options.width || this.el.scrollWidth || this.el.offsetWidth;\r\n    this.el.style.height = options.height || this.el.scrollHeight || this.el.offsetHeight;\r\n\r\n    google.maps.visualRefresh = options.enableNewStyle;\r\n\r\n    for (i = 0; i < options_to_be_deleted.length; i++) {\r\n      delete options[options_to_be_deleted[i]];\r\n    }\r\n\r\n    if(options.disableDefaultUI != true) {\r\n      map_base_options = extend_object(map_base_options, map_controls_options);\r\n    }\r\n\r\n    map_options = extend_object(map_base_options, options);\r\n\r\n    for (i = 0; i < events_that_hide_context_menu.length; i++) {\r\n      delete map_options[events_that_hide_context_menu[i]];\r\n    }\r\n\r\n    for (i = 0; i < events_that_doesnt_hide_context_menu.length; i++) {\r\n      delete map_options[events_that_doesnt_hide_context_menu[i]];\r\n    }\r\n\r\n    /**\r\n     * Google Maps map instance\r\n     *\r\n     * @type {google.maps.Map}\r\n     */\r\n    this.map = new google.maps.Map(this.el, map_options);\r\n\r\n    if (markerClustererFunction) {\r\n      /**\r\n       * Marker Clusterer instance\r\n       *\r\n       * @type {object}\r\n       */\r\n      this.markerClusterer = markerClustererFunction.apply(this, [this.map]);\r\n    }\r\n\r\n    var buildContextMenuHTML = function(control, e) {\r\n      var html = '',\r\n          options = window.context_menu[self.el.id][control];\r\n\r\n      for (var i in options){\r\n        if (options.hasOwnProperty(i)) {\r\n          var option = options[i];\r\n\r\n          html += '<li><a id=\"' + control + '_' + i + '\" href=\"#\">' + option.title + '</a></li>';\r\n        }\r\n      }\r\n\r\n      if (!getElementById('gmaps_context_menu')) return;\r\n\r\n      var context_menu_element = getElementById('gmaps_context_menu');\r\n\r\n      context_menu_element.innerHTML = html;\r\n\r\n      var context_menu_items = context_menu_element.getElementsByTagName('a'),\r\n          context_menu_items_count = context_menu_items.length,\r\n          i;\r\n\r\n      for (i = 0; i < context_menu_items_count; i++) {\r\n        var context_menu_item = context_menu_items[i];\r\n\r\n        var assign_menu_item_action = function(ev){\r\n          ev.preventDefault();\r\n\r\n          options[this.id.replace(control + '_', '')].action.apply(self, [e]);\r\n          self.hideContextMenu();\r\n        };\r\n\r\n        google.maps.event.clearListeners(context_menu_item, 'click');\r\n        google.maps.event.addDomListenerOnce(context_menu_item, 'click', assign_menu_item_action, false);\r\n      }\r\n\r\n      var position = findAbsolutePosition.apply(this, [self.el]),\r\n          left = position[0] + e.pixel.x - 15,\r\n          top = position[1] + e.pixel.y- 15;\r\n\r\n      context_menu_element.style.left = left + \"px\";\r\n      context_menu_element.style.top = top + \"px\";\r\n\r\n      // context_menu_element.style.display = 'block';\r\n    };\r\n\r\n    this.buildContextMenu = function(control, e) {\r\n      if (control === 'marker') {\r\n        e.pixel = {};\r\n\r\n        var overlay = new google.maps.OverlayView();\r\n        overlay.setMap(self.map);\r\n\r\n        overlay.draw = function() {\r\n          var projection = overlay.getProjection(),\r\n              position = e.marker.getPosition();\r\n\r\n          e.pixel = projection.fromLatLngToContainerPixel(position);\r\n\r\n          buildContextMenuHTML(control, e);\r\n        };\r\n      }\r\n      else {\r\n        buildContextMenuHTML(control, e);\r\n      }\r\n\r\n      var context_menu_element = getElementById('gmaps_context_menu');\r\n\r\n      setTimeout(function() {\r\n        context_menu_element.style.display = 'block';\r\n      }, 0);\r\n    };\r\n\r\n    /**\r\n     * Add a context menu for a map or a marker.\r\n     *\r\n     * @param {object} options - The `options` object should contain:\r\n     * * `control` (string): Kind of control the context menu will be attached. Can be \"map\" or \"marker\".\r\n     * * `options` (array): A collection of context menu items:\r\n     *   * `title` (string): Item's title shown in the context menu.\r\n     *   * `name` (string): Item's identifier.\r\n     *   * `action` (function): Function triggered after selecting the context menu item.\r\n     */\r\n    this.setContextMenu = function(options) {\r\n      window.context_menu[self.el.id][options.control] = {};\r\n\r\n      var i,\r\n          ul = doc.createElement('ul');\r\n\r\n      for (i in options.options) {\r\n        if (options.options.hasOwnProperty(i)) {\r\n          var option = options.options[i];\r\n\r\n          window.context_menu[self.el.id][options.control][option.name] = {\r\n            title: option.title,\r\n            action: option.action\r\n          };\r\n        }\r\n      }\r\n\r\n      ul.id = 'gmaps_context_menu';\r\n      ul.style.display = 'none';\r\n      ul.style.position = 'absolute';\r\n      ul.style.minWidth = '100px';\r\n      ul.style.background = 'white';\r\n      ul.style.listStyle = 'none';\r\n      ul.style.padding = '8px';\r\n      ul.style.boxShadow = '2px 2px 6px #ccc';\r\n\r\n      if (!getElementById('gmaps_context_menu')) {\r\n        doc.body.appendChild(ul);\r\n      }\r\n\r\n      var context_menu_element = getElementById('gmaps_context_menu');\r\n\r\n      google.maps.event.addDomListener(context_menu_element, 'mouseout', function(ev) {\r\n        if (!ev.relatedTarget || !this.contains(ev.relatedTarget)) {\r\n          window.setTimeout(function(){\r\n            context_menu_element.style.display = 'none';\r\n          }, 400);\r\n        }\r\n      }, false);\r\n    };\r\n\r\n    /**\r\n     * Hide the current context menu\r\n     */\r\n    this.hideContextMenu = function() {\r\n      var context_menu_element = getElementById('gmaps_context_menu');\r\n\r\n      if (context_menu_element) {\r\n        context_menu_element.style.display = 'none';\r\n      }\r\n    };\r\n\r\n    var setupListener = function(object, name) {\r\n      google.maps.event.addListener(object, name, function(e){\r\n        if (e == undefined) {\r\n          e = this;\r\n        }\r\n\r\n        options[name].apply(this, [e]);\r\n\r\n        self.hideContextMenu();\r\n      });\r\n    };\r\n\r\n    //google.maps.event.addListener(this.map, 'idle', this.hideContextMenu);\r\n    google.maps.event.addListener(this.map, 'zoom_changed', this.hideContextMenu);\r\n\r\n    for (var ev = 0; ev < events_that_hide_context_menu.length; ev++) {\r\n      var name = events_that_hide_context_menu[ev];\r\n\r\n      if (name in options) {\r\n        setupListener(this.map, name);\r\n      }\r\n    }\r\n\r\n    for (var ev = 0; ev < events_that_doesnt_hide_context_menu.length; ev++) {\r\n      var name = events_that_doesnt_hide_context_menu[ev];\r\n\r\n      if (name in options) {\r\n        setupListener(this.map, name);\r\n      }\r\n    }\r\n\r\n    google.maps.event.addListener(this.map, 'rightclick', function(e) {\r\n      if (options.rightclick) {\r\n        options.rightclick.apply(this, [e]);\r\n      }\r\n\r\n      if(window.context_menu[self.el.id]['map'] != undefined) {\r\n        self.buildContextMenu('map', e);\r\n      }\r\n    });\r\n\r\n    /**\r\n     * Trigger a `resize` event, useful if you need to repaint the current map (for changes in the viewport or display / hide actions).\r\n     */\r\n    this.refresh = function() {\r\n      google.maps.event.trigger(this.map, 'resize');\r\n    };\r\n\r\n    /**\r\n     * Adjust the map zoom to include all the markers added in the map.\r\n     */\r\n    this.fitZoom = function() {\r\n      var latLngs = [],\r\n          markers_length = this.markers.length,\r\n          i;\r\n\r\n      for (i = 0; i < markers_length; i++) {\r\n        if(typeof(this.markers[i].visible) === 'boolean' && this.markers[i].visible) {\r\n          latLngs.push(this.markers[i].getPosition());\r\n        }\r\n      }\r\n\r\n      this.fitLatLngBounds(latLngs);\r\n    };\r\n\r\n    /**\r\n     * Adjust the map zoom to include all the coordinates in the `latLngs` array.\r\n     *\r\n     * @param {array} latLngs - Collection of `google.maps.LatLng` objects.\r\n     */\r\n    this.fitLatLngBounds = function(latLngs) {\r\n      var total = latLngs.length,\r\n          bounds = new google.maps.LatLngBounds(),\r\n          i;\r\n\r\n      for(i = 0; i < total; i++) {\r\n        bounds.extend(latLngs[i]);\r\n      }\r\n\r\n      this.map.fitBounds(bounds);\r\n    };\r\n\r\n    /**\r\n     * Center the map using the `lat` and `lng` coordinates.\r\n     *\r\n     * @param {number} lat - Latitude of the coordinate.\r\n     * @param {number} lng - Longitude of the coordinate.\r\n     * @param {function} [callback] - Callback that will be executed after the map is centered.\r\n     */\r\n    this.setCenter = function(lat, lng, callback) {\r\n      this.map.panTo(new google.maps.LatLng(lat, lng));\r\n\r\n      if (callback) {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    /**\r\n     * Return the HTML element container of the map.\r\n     *\r\n     * @returns {HTMLElement} the element container.\r\n     */\r\n    this.getElement = function() {\r\n      return this.el;\r\n    };\r\n\r\n    /**\r\n     * Increase the map's zoom.\r\n     *\r\n     * @param {number} [magnitude] - The number of times the map will be zoomed in.\r\n     */\r\n    this.zoomIn = function(value) {\r\n      value = value || 1;\r\n\r\n      this.zoom = this.map.getZoom() + value;\r\n      this.map.setZoom(this.zoom);\r\n    };\r\n\r\n    /**\r\n     * Decrease the map's zoom.\r\n     *\r\n     * @param {number} [magnitude] - The number of times the map will be zoomed out.\r\n     */\r\n    this.zoomOut = function(value) {\r\n      value = value || 1;\r\n\r\n      this.zoom = this.map.getZoom() - value;\r\n      this.map.setZoom(this.zoom);\r\n    };\r\n\r\n    var native_methods = [],\r\n        method;\r\n\r\n    for (method in this.map) {\r\n      if (typeof(this.map[method]) == 'function' && !this[method]) {\r\n        native_methods.push(method);\r\n      }\r\n    }\r\n\r\n    for (i = 0; i < native_methods.length; i++) {\r\n      (function(gmaps, scope, method_name) {\r\n        gmaps[method_name] = function(){\r\n          return scope[method_name].apply(scope, arguments);\r\n        };\r\n      })(this, this.map, native_methods[i]);\r\n    }\r\n  };\r\n\r\n  return GMaps;\r\n})(this);\r\n\r\nGMaps.prototype.createControl = function(options) {\r\n  var control = document.createElement('div');\r\n\r\n  control.style.cursor = 'pointer';\r\n\r\n  if (options.disableDefaultStyles !== true) {\r\n    control.style.fontFamily = 'Roboto, Arial, sans-serif';\r\n    control.style.fontSize = '11px';\r\n    control.style.boxShadow = 'rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px';\r\n  }\r\n\r\n  for (var option in options.style) {\r\n    control.style[option] = options.style[option];\r\n  }\r\n\r\n  if (options.id) {\r\n    control.id = options.id;\r\n  }\r\n\r\n  if (options.title) {\r\n    control.title = options.title;\r\n  }\r\n\r\n  if (options.classes) {\r\n    control.className = options.classes;\r\n  }\r\n\r\n  if (options.content) {\r\n    if (typeof options.content === 'string') {\r\n      control.innerHTML = options.content;\r\n    }\r\n    else if (options.content instanceof HTMLElement) {\r\n      control.appendChild(options.content);\r\n    }\r\n  }\r\n\r\n  if (options.position) {\r\n    control.position = google.maps.ControlPosition[options.position.toUpperCase()];\r\n  }\r\n\r\n  for (var ev in options.events) {\r\n    (function(object, name) {\r\n      google.maps.event.addDomListener(object, name, function(){\r\n        options.events[name].apply(this, [this]);\r\n      });\r\n    })(control, ev);\r\n  }\r\n\r\n  control.index = 1;\r\n\r\n  return control;\r\n};\r\n\r\n/**\r\n * Add a custom control to the map UI.\r\n *\r\n * @param {object} options - The `options` object should contain:\r\n * * `style` (object): The keys and values of this object should be valid CSS properties and values.\r\n * * `id` (string): The HTML id for the custom control.\r\n * * `classes` (string): A string containing all the HTML classes for the custom control.\r\n * * `content` (string or HTML element): The content of the custom control.\r\n * * `position` (string): Any valid [`google.maps.ControlPosition`](https://developers.google.com/maps/documentation/javascript/controls#ControlPositioning) value, in lower or upper case.\r\n * * `events` (object): The keys of this object should be valid DOM events. The values should be functions.\r\n * * `disableDefaultStyles` (boolean): If false, removes the default styles for the controls like font (family and size), and box shadow.\r\n * @returns {HTMLElement}\r\n */\r\nGMaps.prototype.addControl = function(options) {\r\n  var control = this.createControl(options);\r\n\r\n  this.controls.push(control);\r\n  this.map.controls[control.position].push(control);\r\n\r\n  return control;\r\n};\r\n\r\n/**\r\n * Remove a control from the map. `control` should be a control returned by `addControl()`.\r\n *\r\n * @param {HTMLElement} control - One of the controls returned by `addControl()`.\r\n * @returns {HTMLElement} the removed control.\r\n */\r\nGMaps.prototype.removeControl = function(control) {\r\n  var position = null,\r\n      i;\r\n\r\n  for (i = 0; i < this.controls.length; i++) {\r\n    if (this.controls[i] == control) {\r\n      position = this.controls[i].position;\r\n      this.controls.splice(i, 1);\r\n    }\r\n  }\r\n\r\n  if (position) {\r\n    for (i = 0; i < this.map.controls.length; i++) {\r\n      var controlsForPosition = this.map.controls[control.position];\r\n\r\n      if (controlsForPosition.getAt(i) == control) {\r\n        controlsForPosition.removeAt(i);\r\n\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return control;\r\n};\r\n\r\nGMaps.prototype.createMarker = function(options) {\r\n  if (options.lat == undefined && options.lng == undefined && options.position == undefined) {\r\n    throw 'No latitude or longitude defined.';\r\n  }\r\n\r\n  var self = this,\r\n      details = options.details,\r\n      fences = options.fences,\r\n      outside = options.outside,\r\n      base_options = {\r\n        position: new google.maps.LatLng(options.lat, options.lng),\r\n        map: null\r\n      },\r\n      marker_options = extend_object(base_options, options);\r\n\r\n  delete marker_options.lat;\r\n  delete marker_options.lng;\r\n  delete marker_options.fences;\r\n  delete marker_options.outside;\r\n\r\n  var marker = new google.maps.Marker(marker_options);\r\n\r\n  marker.fences = fences;\r\n\r\n  if (options.infoWindow) {\r\n    marker.infoWindow = new google.maps.InfoWindow(options.infoWindow);\r\n\r\n    var info_window_events = ['closeclick', 'content_changed', 'domready', 'position_changed', 'zindex_changed'];\r\n\r\n    for (var ev = 0; ev < info_window_events.length; ev++) {\r\n      (function(object, name) {\r\n        if (options.infoWindow[name]) {\r\n          google.maps.event.addListener(object, name, function(e){\r\n            options.infoWindow[name].apply(this, [e]);\r\n          });\r\n        }\r\n      })(marker.infoWindow, info_window_events[ev]);\r\n    }\r\n  }\r\n\r\n  var marker_events = ['animation_changed', 'clickable_changed', 'cursor_changed', 'draggable_changed', 'flat_changed', 'icon_changed', 'position_changed', 'shadow_changed', 'shape_changed', 'title_changed', 'visible_changed', 'zindex_changed'];\r\n\r\n  var marker_events_with_mouse = ['dblclick', 'drag', 'dragend', 'dragstart', 'mousedown', 'mouseout', 'mouseover', 'mouseup'];\r\n\r\n  for (var ev = 0; ev < marker_events.length; ev++) {\r\n    (function(object, name) {\r\n      if (options[name]) {\r\n        google.maps.event.addListener(object, name, function(){\r\n          options[name].apply(this, [this]);\r\n        });\r\n      }\r\n    })(marker, marker_events[ev]);\r\n  }\r\n\r\n  for (var ev = 0; ev < marker_events_with_mouse.length; ev++) {\r\n    (function(map, object, name) {\r\n      if (options[name]) {\r\n        google.maps.event.addListener(object, name, function(me){\r\n          if(!me.pixel){\r\n            me.pixel = map.getProjection().fromLatLngToPoint(me.latLng)\r\n          }\r\n\r\n          options[name].apply(this, [me]);\r\n        });\r\n      }\r\n    })(this.map, marker, marker_events_with_mouse[ev]);\r\n  }\r\n\r\n  google.maps.event.addListener(marker, 'click', function() {\r\n    this.details = details;\r\n\r\n    if (options.click) {\r\n      options.click.apply(this, [this]);\r\n    }\r\n\r\n    if (marker.infoWindow) {\r\n      self.hideInfoWindows();\r\n      marker.infoWindow.open(self.map, marker);\r\n    }\r\n  });\r\n\r\n  google.maps.event.addListener(marker, 'rightclick', function(e) {\r\n    e.marker = this;\r\n\r\n    if (options.rightclick) {\r\n      options.rightclick.apply(this, [e]);\r\n    }\r\n\r\n    if (window.context_menu[self.el.id]['marker'] != undefined) {\r\n      self.buildContextMenu('marker', e);\r\n    }\r\n  });\r\n\r\n  if (marker.fences) {\r\n    google.maps.event.addListener(marker, 'dragend', function() {\r\n      self.checkMarkerGeofence(marker, function(m, f) {\r\n        outside(m, f);\r\n      });\r\n    });\r\n  }\r\n\r\n  return marker;\r\n};\r\n\r\nGMaps.prototype.addMarker = function(options) {\r\n  var marker;\r\n  if(options.hasOwnProperty('gm_accessors_')) {\r\n    // Native google.maps.Marker object\r\n    marker = options;\r\n  }\r\n  else {\r\n    if ((options.hasOwnProperty('lat') && options.hasOwnProperty('lng')) || options.position) {\r\n      marker = this.createMarker(options);\r\n    }\r\n    else {\r\n      throw 'No latitude or longitude defined.';\r\n    }\r\n  }\r\n\r\n  marker.setMap(this.map);\r\n\r\n  if(this.markerClusterer) {\r\n    this.markerClusterer.addMarker(marker);\r\n  }\r\n\r\n  this.markers.push(marker);\r\n\r\n  GMaps.fire('marker_added', marker, this);\r\n\r\n  return marker;\r\n};\r\n\r\nGMaps.prototype.addMarkers = function(array) {\r\n  for (var i = 0, marker; marker=array[i]; i++) {\r\n    this.addMarker(marker);\r\n  }\r\n\r\n  return this.markers;\r\n};\r\n\r\nGMaps.prototype.hideInfoWindows = function() {\r\n  for (var i = 0, marker; marker = this.markers[i]; i++){\r\n    if (marker.infoWindow) {\r\n      marker.infoWindow.close();\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.prototype.removeMarker = function(marker) {\r\n  for (var i = 0; i < this.markers.length; i++) {\r\n    if (this.markers[i] === marker) {\r\n      this.markers[i].setMap(null);\r\n      this.markers.splice(i, 1);\r\n\r\n      if(this.markerClusterer) {\r\n        this.markerClusterer.removeMarker(marker);\r\n      }\r\n\r\n      GMaps.fire('marker_removed', marker, this);\r\n\r\n      break;\r\n    }\r\n  }\r\n\r\n  return marker;\r\n};\r\n\r\nGMaps.prototype.removeMarkers = function (collection) {\r\n  var new_markers = [];\r\n\r\n  if (typeof collection == 'undefined') {\r\n    for (var i = 0; i < this.markers.length; i++) {\r\n      var marker = this.markers[i];\r\n      marker.setMap(null);\r\n\r\n      GMaps.fire('marker_removed', marker, this);\r\n    }\r\n\r\n    if(this.markerClusterer && this.markerClusterer.clearMarkers) {\r\n      this.markerClusterer.clearMarkers();\r\n    }\r\n\r\n    this.markers = new_markers;\r\n  }\r\n  else {\r\n    for (var i = 0; i < collection.length; i++) {\r\n      var index = this.markers.indexOf(collection[i]);\r\n\r\n      if (index > -1) {\r\n        var marker = this.markers[index];\r\n        marker.setMap(null);\r\n\r\n        if(this.markerClusterer) {\r\n          this.markerClusterer.removeMarker(marker);\r\n        }\r\n\r\n        GMaps.fire('marker_removed', marker, this);\r\n      }\r\n    }\r\n\r\n    for (var i = 0; i < this.markers.length; i++) {\r\n      var marker = this.markers[i];\r\n      if (marker.getMap() != null) {\r\n        new_markers.push(marker);\r\n      }\r\n    }\r\n\r\n    this.markers = new_markers;\r\n  }\r\n};\r\n\r\nGMaps.prototype.drawOverlay = function(options) {\r\n  var overlay = new google.maps.OverlayView(),\r\n      auto_show = true;\r\n\r\n  overlay.setMap(this.map);\r\n\r\n  if (options.auto_show != null) {\r\n    auto_show = options.auto_show;\r\n  }\r\n\r\n  overlay.onAdd = function() {\r\n    var el = document.createElement('div');\r\n\r\n    el.style.borderStyle = \"none\";\r\n    el.style.borderWidth = \"0px\";\r\n    el.style.position = \"absolute\";\r\n    el.style.zIndex = 100;\r\n    el.innerHTML = options.content;\r\n\r\n    overlay.el = el;\r\n\r\n    if (!options.layer) {\r\n      options.layer = 'overlayLayer';\r\n    }\r\n\r\n    var panes = this.getPanes(),\r\n        overlayLayer = panes[options.layer],\r\n        stop_overlay_events = ['contextmenu', 'DOMMouseScroll', 'dblclick', 'mousedown'];\r\n\r\n    overlayLayer.appendChild(el);\r\n\r\n    for (var ev = 0; ev < stop_overlay_events.length; ev++) {\r\n      (function(object, name) {\r\n        google.maps.event.addDomListener(object, name, function(e){\r\n          if (navigator.userAgent.toLowerCase().indexOf('msie') != -1 && document.all) {\r\n            e.cancelBubble = true;\r\n            e.returnValue = false;\r\n          }\r\n          else {\r\n            e.stopPropagation();\r\n          }\r\n        });\r\n      })(el, stop_overlay_events[ev]);\r\n    }\r\n\r\n    if (options.click) {\r\n      panes.overlayMouseTarget.appendChild(overlay.el);\r\n      google.maps.event.addDomListener(overlay.el, 'click', function() {\r\n        options.click.apply(overlay, [overlay]);\r\n      });\r\n    }\r\n\r\n    google.maps.event.trigger(this, 'ready');\r\n  };\r\n\r\n  overlay.draw = function() {\r\n    var projection = this.getProjection(),\r\n        pixel = projection.fromLatLngToDivPixel(new google.maps.LatLng(options.lat, options.lng));\r\n\r\n    options.horizontalOffset = options.horizontalOffset || 0;\r\n    options.verticalOffset = options.verticalOffset || 0;\r\n\r\n    var el = overlay.el,\r\n        content = el.children[0],\r\n        content_height = content.clientHeight,\r\n        content_width = content.clientWidth;\r\n\r\n    switch (options.verticalAlign) {\r\n      case 'top':\r\n        el.style.top = (pixel.y - content_height + options.verticalOffset) + 'px';\r\n        break;\r\n      default:\r\n      case 'middle':\r\n        el.style.top = (pixel.y - (content_height / 2) + options.verticalOffset) + 'px';\r\n        break;\r\n      case 'bottom':\r\n        el.style.top = (pixel.y + options.verticalOffset) + 'px';\r\n        break;\r\n    }\r\n\r\n    switch (options.horizontalAlign) {\r\n      case 'left':\r\n        el.style.left = (pixel.x - content_width + options.horizontalOffset) + 'px';\r\n        break;\r\n      default:\r\n      case 'center':\r\n        el.style.left = (pixel.x - (content_width / 2) + options.horizontalOffset) + 'px';\r\n        break;\r\n      case 'right':\r\n        el.style.left = (pixel.x + options.horizontalOffset) + 'px';\r\n        break;\r\n    }\r\n\r\n    el.style.display = auto_show ? 'block' : 'none';\r\n\r\n    if (!auto_show) {\r\n      options.show.apply(this, [el]);\r\n    }\r\n  };\r\n\r\n  overlay.onRemove = function() {\r\n    var el = overlay.el;\r\n\r\n    if (options.remove) {\r\n      options.remove.apply(this, [el]);\r\n    }\r\n    else {\r\n      overlay.el.parentNode.removeChild(overlay.el);\r\n      overlay.el = null;\r\n    }\r\n  };\r\n\r\n  this.overlays.push(overlay);\r\n  return overlay;\r\n};\r\n\r\nGMaps.prototype.removeOverlay = function(overlay) {\r\n  for (var i = 0; i < this.overlays.length; i++) {\r\n    if (this.overlays[i] === overlay) {\r\n      this.overlays[i].setMap(null);\r\n      this.overlays.splice(i, 1);\r\n\r\n      break;\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.prototype.removeOverlays = function() {\r\n  for (var i = 0, item; item = this.overlays[i]; i++) {\r\n    item.setMap(null);\r\n  }\r\n\r\n  this.overlays = [];\r\n};\r\n\r\nGMaps.prototype.drawPolyline = function(options) {\r\n  var path = [],\r\n      points = options.path;\r\n\r\n  if (points.length) {\r\n    if (points[0][0] === undefined) {\r\n      path = points;\r\n    }\r\n    else {\r\n      for (var i = 0, latlng; latlng = points[i]; i++) {\r\n        path.push(new google.maps.LatLng(latlng[0], latlng[1]));\r\n      }\r\n    }\r\n  }\r\n\r\n  var polyline_options = {\r\n    map: this.map,\r\n    path: path,\r\n    strokeColor: options.strokeColor,\r\n    strokeOpacity: options.strokeOpacity,\r\n    strokeWeight: options.strokeWeight,\r\n    geodesic: options.geodesic,\r\n    clickable: true,\r\n    editable: false,\r\n    visible: true\r\n  };\r\n\r\n  if (options.hasOwnProperty(\"clickable\")) {\r\n    polyline_options.clickable = options.clickable;\r\n  }\r\n\r\n  if (options.hasOwnProperty(\"editable\")) {\r\n    polyline_options.editable = options.editable;\r\n  }\r\n\r\n  if (options.hasOwnProperty(\"icons\")) {\r\n    polyline_options.icons = options.icons;\r\n  }\r\n\r\n  if (options.hasOwnProperty(\"zIndex\")) {\r\n    polyline_options.zIndex = options.zIndex;\r\n  }\r\n\r\n  var polyline = new google.maps.Polyline(polyline_options);\r\n\r\n  var polyline_events = ['click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'rightclick'];\r\n\r\n  for (var ev = 0; ev < polyline_events.length; ev++) {\r\n    (function(object, name) {\r\n      if (options[name]) {\r\n        google.maps.event.addListener(object, name, function(e){\r\n          options[name].apply(this, [e]);\r\n        });\r\n      }\r\n    })(polyline, polyline_events[ev]);\r\n  }\r\n\r\n  this.polylines.push(polyline);\r\n\r\n  GMaps.fire('polyline_added', polyline, this);\r\n\r\n  return polyline;\r\n};\r\n\r\nGMaps.prototype.removePolyline = function(polyline) {\r\n  for (var i = 0; i < this.polylines.length; i++) {\r\n    if (this.polylines[i] === polyline) {\r\n      this.polylines[i].setMap(null);\r\n      this.polylines.splice(i, 1);\r\n\r\n      GMaps.fire('polyline_removed', polyline, this);\r\n\r\n      break;\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.prototype.removePolylines = function() {\r\n  for (var i = 0, item; item = this.polylines[i]; i++) {\r\n    item.setMap(null);\r\n  }\r\n\r\n  this.polylines = [];\r\n};\r\n\r\nGMaps.prototype.drawCircle = function(options) {\r\n  options =  extend_object({\r\n    map: this.map,\r\n    center: new google.maps.LatLng(options.lat, options.lng)\r\n  }, options);\r\n\r\n  delete options.lat;\r\n  delete options.lng;\r\n\r\n  var polygon = new google.maps.Circle(options),\r\n      polygon_events = ['click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'rightclick'];\r\n\r\n  for (var ev = 0; ev < polygon_events.length; ev++) {\r\n    (function(object, name) {\r\n      if (options[name]) {\r\n        google.maps.event.addListener(object, name, function(e){\r\n          options[name].apply(this, [e]);\r\n        });\r\n      }\r\n    })(polygon, polygon_events[ev]);\r\n  }\r\n\r\n  this.polygons.push(polygon);\r\n\r\n  return polygon;\r\n};\r\n\r\nGMaps.prototype.drawRectangle = function(options) {\r\n  options = extend_object({\r\n    map: this.map\r\n  }, options);\r\n\r\n  var latLngBounds = new google.maps.LatLngBounds(\r\n    new google.maps.LatLng(options.bounds[0][0], options.bounds[0][1]),\r\n    new google.maps.LatLng(options.bounds[1][0], options.bounds[1][1])\r\n  );\r\n\r\n  options.bounds = latLngBounds;\r\n\r\n  var polygon = new google.maps.Rectangle(options),\r\n      polygon_events = ['click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'rightclick'];\r\n\r\n  for (var ev = 0; ev < polygon_events.length; ev++) {\r\n    (function(object, name) {\r\n      if (options[name]) {\r\n        google.maps.event.addListener(object, name, function(e){\r\n          options[name].apply(this, [e]);\r\n        });\r\n      }\r\n    })(polygon, polygon_events[ev]);\r\n  }\r\n\r\n  this.polygons.push(polygon);\r\n\r\n  return polygon;\r\n};\r\n\r\nGMaps.prototype.drawPolygon = function(options) {\r\n  var useGeoJSON = false;\r\n\r\n  if(options.hasOwnProperty(\"useGeoJSON\")) {\r\n    useGeoJSON = options.useGeoJSON;\r\n  }\r\n\r\n  delete options.useGeoJSON;\r\n\r\n  options = extend_object({\r\n    map: this.map\r\n  }, options);\r\n\r\n  if (useGeoJSON == false) {\r\n    options.paths = [options.paths.slice(0)];\r\n  }\r\n\r\n  if (options.paths.length > 0) {\r\n    if (options.paths[0].length > 0) {\r\n      options.paths = array_flat(array_map(options.paths, arrayToLatLng, useGeoJSON));\r\n    }\r\n  }\r\n\r\n  var polygon = new google.maps.Polygon(options),\r\n      polygon_events = ['click', 'dblclick', 'mousedown', 'mousemove', 'mouseout', 'mouseover', 'mouseup', 'rightclick'];\r\n\r\n  for (var ev = 0; ev < polygon_events.length; ev++) {\r\n    (function(object, name) {\r\n      if (options[name]) {\r\n        google.maps.event.addListener(object, name, function(e){\r\n          options[name].apply(this, [e]);\r\n        });\r\n      }\r\n    })(polygon, polygon_events[ev]);\r\n  }\r\n\r\n  this.polygons.push(polygon);\r\n\r\n  GMaps.fire('polygon_added', polygon, this);\r\n\r\n  return polygon;\r\n};\r\n\r\nGMaps.prototype.removePolygon = function(polygon) {\r\n  for (var i = 0; i < this.polygons.length; i++) {\r\n    if (this.polygons[i] === polygon) {\r\n      this.polygons[i].setMap(null);\r\n      this.polygons.splice(i, 1);\r\n\r\n      GMaps.fire('polygon_removed', polygon, this);\r\n\r\n      break;\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.prototype.removePolygons = function() {\r\n  for (var i = 0, item; item = this.polygons[i]; i++) {\r\n    item.setMap(null);\r\n  }\r\n\r\n  this.polygons = [];\r\n};\r\n\r\nGMaps.prototype.getFromFusionTables = function(options) {\r\n  var events = options.events;\r\n\r\n  delete options.events;\r\n\r\n  var fusion_tables_options = options,\r\n      layer = new google.maps.FusionTablesLayer(fusion_tables_options);\r\n\r\n  for (var ev in events) {\r\n    (function(object, name) {\r\n      google.maps.event.addListener(object, name, function(e) {\r\n        events[name].apply(this, [e]);\r\n      });\r\n    })(layer, ev);\r\n  }\r\n\r\n  this.layers.push(layer);\r\n\r\n  return layer;\r\n};\r\n\r\nGMaps.prototype.loadFromFusionTables = function(options) {\r\n  var layer = this.getFromFusionTables(options);\r\n  layer.setMap(this.map);\r\n\r\n  return layer;\r\n};\r\n\r\nGMaps.prototype.getFromKML = function(options) {\r\n  var url = options.url,\r\n      events = options.events;\r\n\r\n  delete options.url;\r\n  delete options.events;\r\n\r\n  var kml_options = options,\r\n      layer = new google.maps.KmlLayer(url, kml_options);\r\n\r\n  for (var ev in events) {\r\n    (function(object, name) {\r\n      google.maps.event.addListener(object, name, function(e) {\r\n        events[name].apply(this, [e]);\r\n      });\r\n    })(layer, ev);\r\n  }\r\n\r\n  this.layers.push(layer);\r\n\r\n  return layer;\r\n};\r\n\r\nGMaps.prototype.loadFromKML = function(options) {\r\n  var layer = this.getFromKML(options);\r\n  layer.setMap(this.map);\r\n\r\n  return layer;\r\n};\r\n\r\nGMaps.prototype.addLayer = function(layerName, options) {\r\n  //var default_layers = ['weather', 'clouds', 'traffic', 'transit', 'bicycling', 'panoramio', 'places'];\r\n  options = options || {};\r\n  var layer;\r\n\r\n  switch(layerName) {\r\n    case 'weather': this.singleLayers.weather = layer = new google.maps.weather.WeatherLayer();\r\n      break;\r\n    case 'clouds': this.singleLayers.clouds = layer = new google.maps.weather.CloudLayer();\r\n      break;\r\n    case 'traffic': this.singleLayers.traffic = layer = new google.maps.TrafficLayer();\r\n      break;\r\n    case 'transit': this.singleLayers.transit = layer = new google.maps.TransitLayer();\r\n      break;\r\n    case 'bicycling': this.singleLayers.bicycling = layer = new google.maps.BicyclingLayer();\r\n      break;\r\n    case 'panoramio':\r\n        this.singleLayers.panoramio = layer = new google.maps.panoramio.PanoramioLayer();\r\n        layer.setTag(options.filter);\r\n        delete options.filter;\r\n\r\n        //click event\r\n        if (options.click) {\r\n          google.maps.event.addListener(layer, 'click', function(event) {\r\n            options.click(event);\r\n            delete options.click;\r\n          });\r\n        }\r\n      break;\r\n      case 'places':\r\n        this.singleLayers.places = layer = new google.maps.places.PlacesService(this.map);\r\n\r\n        //search, nearbySearch, radarSearch callback, Both are the same\r\n        if (options.search || options.nearbySearch || options.radarSearch) {\r\n          var placeSearchRequest  = {\r\n            bounds : options.bounds || null,\r\n            keyword : options.keyword || null,\r\n            location : options.location || null,\r\n            name : options.name || null,\r\n            radius : options.radius || null,\r\n            rankBy : options.rankBy || null,\r\n            types : options.types || null\r\n          };\r\n\r\n          if (options.radarSearch) {\r\n            layer.radarSearch(placeSearchRequest, options.radarSearch);\r\n          }\r\n\r\n          if (options.search) {\r\n            layer.search(placeSearchRequest, options.search);\r\n          }\r\n\r\n          if (options.nearbySearch) {\r\n            layer.nearbySearch(placeSearchRequest, options.nearbySearch);\r\n          }\r\n        }\r\n\r\n        //textSearch callback\r\n        if (options.textSearch) {\r\n          var textSearchRequest  = {\r\n            bounds : options.bounds || null,\r\n            location : options.location || null,\r\n            query : options.query || null,\r\n            radius : options.radius || null\r\n          };\r\n\r\n          layer.textSearch(textSearchRequest, options.textSearch);\r\n        }\r\n      break;\r\n  }\r\n\r\n  if (layer !== undefined) {\r\n    if (typeof layer.setOptions == 'function') {\r\n      layer.setOptions(options);\r\n    }\r\n    if (typeof layer.setMap == 'function') {\r\n      layer.setMap(this.map);\r\n    }\r\n\r\n    return layer;\r\n  }\r\n};\r\n\r\nGMaps.prototype.removeLayer = function(layer) {\r\n  if (typeof(layer) == \"string\" && this.singleLayers[layer] !== undefined) {\r\n     this.singleLayers[layer].setMap(null);\r\n\r\n     delete this.singleLayers[layer];\r\n  }\r\n  else {\r\n    for (var i = 0; i < this.layers.length; i++) {\r\n      if (this.layers[i] === layer) {\r\n        this.layers[i].setMap(null);\r\n        this.layers.splice(i, 1);\r\n\r\n        break;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nvar travelMode, unitSystem;\r\n\r\nGMaps.prototype.getRoutes = function(options) {\r\n  switch (options.travelMode) {\r\n    case 'bicycling':\r\n      travelMode = google.maps.TravelMode.BICYCLING;\r\n      break;\r\n    case 'transit':\r\n      travelMode = google.maps.TravelMode.TRANSIT;\r\n      break;\r\n    case 'driving':\r\n      travelMode = google.maps.TravelMode.DRIVING;\r\n      break;\r\n    default:\r\n      travelMode = google.maps.TravelMode.WALKING;\r\n      break;\r\n  }\r\n\r\n  if (options.unitSystem === 'imperial') {\r\n    unitSystem = google.maps.UnitSystem.IMPERIAL;\r\n  }\r\n  else {\r\n    unitSystem = google.maps.UnitSystem.METRIC;\r\n  }\r\n\r\n  var base_options = {\r\n        avoidHighways: false,\r\n        avoidTolls: false,\r\n        optimizeWaypoints: false,\r\n        waypoints: []\r\n      },\r\n      request_options =  extend_object(base_options, options);\r\n\r\n  request_options.origin = /string/.test(typeof options.origin) ? options.origin : new google.maps.LatLng(options.origin[0], options.origin[1]);\r\n  request_options.destination = /string/.test(typeof options.destination) ? options.destination : new google.maps.LatLng(options.destination[0], options.destination[1]);\r\n  request_options.travelMode = travelMode;\r\n  request_options.unitSystem = unitSystem;\r\n\r\n  delete request_options.callback;\r\n  delete request_options.error;\r\n\r\n  var self = this,\r\n      routes = [],\r\n      service = new google.maps.DirectionsService();\r\n\r\n  service.route(request_options, function(result, status) {\r\n    if (status === google.maps.DirectionsStatus.OK) {\r\n      for (var r in result.routes) {\r\n        if (result.routes.hasOwnProperty(r)) {\r\n          routes.push(result.routes[r]);\r\n        }\r\n      }\r\n\r\n      if (options.callback) {\r\n        options.callback(routes, result, status);\r\n      }\r\n    }\r\n    else {\r\n      if (options.error) {\r\n        options.error(result, status);\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nGMaps.prototype.removeRoutes = function() {\r\n  this.routes.length = 0;\r\n};\r\n\r\nGMaps.prototype.getElevations = function(options) {\r\n  options = extend_object({\r\n    locations: [],\r\n    path : false,\r\n    samples : 256\r\n  }, options);\r\n\r\n  if (options.locations.length > 0) {\r\n    if (options.locations[0].length > 0) {\r\n      options.locations = array_flat(array_map([options.locations], arrayToLatLng,  false));\r\n    }\r\n  }\r\n\r\n  var callback = options.callback;\r\n  delete options.callback;\r\n\r\n  var service = new google.maps.ElevationService();\r\n\r\n  //location request\r\n  if (!options.path) {\r\n    delete options.path;\r\n    delete options.samples;\r\n\r\n    service.getElevationForLocations(options, function(result, status) {\r\n      if (callback && typeof(callback) === \"function\") {\r\n        callback(result, status);\r\n      }\r\n    });\r\n  //path request\r\n  } else {\r\n    var pathRequest = {\r\n      path : options.locations,\r\n      samples : options.samples\r\n    };\r\n\r\n    service.getElevationAlongPath(pathRequest, function(result, status) {\r\n     if (callback && typeof(callback) === \"function\") {\r\n        callback(result, status);\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\nGMaps.prototype.cleanRoute = GMaps.prototype.removePolylines;\r\n\r\nGMaps.prototype.renderRoute = function(options, renderOptions) {\r\n  var self = this,\r\n      panel = ((typeof renderOptions.panel === 'string') ? document.getElementById(renderOptions.panel.replace('#', '')) : renderOptions.panel),\r\n      display;\r\n\r\n  renderOptions.panel = panel;\r\n  renderOptions = extend_object({\r\n    map: this.map\r\n  }, renderOptions);\r\n  display = new google.maps.DirectionsRenderer(renderOptions);\r\n\r\n  this.getRoutes({\r\n    origin: options.origin,\r\n    destination: options.destination,\r\n    travelMode: options.travelMode,\r\n    waypoints: options.waypoints,\r\n    unitSystem: options.unitSystem,\r\n    error: options.error,\r\n    avoidHighways: options.avoidHighways,\r\n    avoidTolls: options.avoidTolls,\r\n    optimizeWaypoints: options.optimizeWaypoints,\r\n    callback: function(routes, response, status) {\r\n      if (status === google.maps.DirectionsStatus.OK) {\r\n        display.setDirections(response);\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nGMaps.prototype.drawRoute = function(options) {\r\n  var self = this;\r\n\r\n  this.getRoutes({\r\n    origin: options.origin,\r\n    destination: options.destination,\r\n    travelMode: options.travelMode,\r\n    waypoints: options.waypoints,\r\n    unitSystem: options.unitSystem,\r\n    error: options.error,\r\n    avoidHighways: options.avoidHighways,\r\n    avoidTolls: options.avoidTolls,\r\n    optimizeWaypoints: options.optimizeWaypoints,\r\n    callback: function(routes) {\r\n      if (routes.length > 0) {\r\n        var polyline_options = {\r\n          path: routes[routes.length - 1].overview_path,\r\n          strokeColor: options.strokeColor,\r\n          strokeOpacity: options.strokeOpacity,\r\n          strokeWeight: options.strokeWeight\r\n        };\r\n\r\n        if (options.hasOwnProperty(\"icons\")) {\r\n          polyline_options.icons = options.icons;\r\n        }\r\n\r\n        self.drawPolyline(polyline_options);\r\n\r\n        if (options.callback) {\r\n          options.callback(routes[routes.length - 1]);\r\n        }\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nGMaps.prototype.travelRoute = function(options) {\r\n  if (options.origin && options.destination) {\r\n    this.getRoutes({\r\n      origin: options.origin,\r\n      destination: options.destination,\r\n      travelMode: options.travelMode,\r\n      waypoints : options.waypoints,\r\n      unitSystem: options.unitSystem,\r\n      error: options.error,\r\n      callback: function(e) {\r\n        //start callback\r\n        if (e.length > 0 && options.start) {\r\n          options.start(e[e.length - 1]);\r\n        }\r\n\r\n        //step callback\r\n        if (e.length > 0 && options.step) {\r\n          var route = e[e.length - 1];\r\n          if (route.legs.length > 0) {\r\n            var steps = route.legs[0].steps;\r\n            for (var i = 0, step; step = steps[i]; i++) {\r\n              step.step_number = i;\r\n              options.step(step, (route.legs[0].steps.length - 1));\r\n            }\r\n          }\r\n        }\r\n\r\n        //end callback\r\n        if (e.length > 0 && options.end) {\r\n           options.end(e[e.length - 1]);\r\n        }\r\n      }\r\n    });\r\n  }\r\n  else if (options.route) {\r\n    if (options.route.legs.length > 0) {\r\n      var steps = options.route.legs[0].steps;\r\n      for (var i = 0, step; step = steps[i]; i++) {\r\n        step.step_number = i;\r\n        options.step(step);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.prototype.drawSteppedRoute = function(options) {\r\n  var self = this;\r\n\r\n  if (options.origin && options.destination) {\r\n    this.getRoutes({\r\n      origin: options.origin,\r\n      destination: options.destination,\r\n      travelMode: options.travelMode,\r\n      waypoints : options.waypoints,\r\n      error: options.error,\r\n      callback: function(e) {\r\n        //start callback\r\n        if (e.length > 0 && options.start) {\r\n          options.start(e[e.length - 1]);\r\n        }\r\n\r\n        //step callback\r\n        if (e.length > 0 && options.step) {\r\n          var route = e[e.length - 1];\r\n          if (route.legs.length > 0) {\r\n            var steps = route.legs[0].steps;\r\n            for (var i = 0, step; step = steps[i]; i++) {\r\n              step.step_number = i;\r\n              var polyline_options = {\r\n                path: step.path,\r\n                strokeColor: options.strokeColor,\r\n                strokeOpacity: options.strokeOpacity,\r\n                strokeWeight: options.strokeWeight\r\n              };\r\n\r\n              if (options.hasOwnProperty(\"icons\")) {\r\n                polyline_options.icons = options.icons;\r\n              }\r\n\r\n              self.drawPolyline(polyline_options);\r\n              options.step(step, (route.legs[0].steps.length - 1));\r\n            }\r\n          }\r\n        }\r\n\r\n        //end callback\r\n        if (e.length > 0 && options.end) {\r\n           options.end(e[e.length - 1]);\r\n        }\r\n      }\r\n    });\r\n  }\r\n  else if (options.route) {\r\n    if (options.route.legs.length > 0) {\r\n      var steps = options.route.legs[0].steps;\r\n      for (var i = 0, step; step = steps[i]; i++) {\r\n        step.step_number = i;\r\n        var polyline_options = {\r\n          path: step.path,\r\n          strokeColor: options.strokeColor,\r\n          strokeOpacity: options.strokeOpacity,\r\n          strokeWeight: options.strokeWeight\r\n        };\r\n\r\n        if (options.hasOwnProperty(\"icons\")) {\r\n          polyline_options.icons = options.icons;\r\n        }\r\n\r\n        self.drawPolyline(polyline_options);\r\n        options.step(step);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.Route = function(options) {\r\n  this.origin = options.origin;\r\n  this.destination = options.destination;\r\n  this.waypoints = options.waypoints;\r\n\r\n  this.map = options.map;\r\n  this.route = options.route;\r\n  this.step_count = 0;\r\n  this.steps = this.route.legs[0].steps;\r\n  this.steps_length = this.steps.length;\r\n\r\n  var polyline_options = {\r\n    path: new google.maps.MVCArray(),\r\n    strokeColor: options.strokeColor,\r\n    strokeOpacity: options.strokeOpacity,\r\n    strokeWeight: options.strokeWeight\r\n  };\r\n\r\n  if (options.hasOwnProperty(\"icons\")) {\r\n    polyline_options.icons = options.icons;\r\n  }\r\n\r\n  this.polyline = this.map.drawPolyline(polyline_options).getPath();\r\n};\r\n\r\nGMaps.Route.prototype.getRoute = function(options) {\r\n  var self = this;\r\n\r\n  this.map.getRoutes({\r\n    origin : this.origin,\r\n    destination : this.destination,\r\n    travelMode : options.travelMode,\r\n    waypoints : this.waypoints || [],\r\n    error: options.error,\r\n    callback : function() {\r\n      self.route = e[0];\r\n\r\n      if (options.callback) {\r\n        options.callback.call(self);\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nGMaps.Route.prototype.back = function() {\r\n  if (this.step_count > 0) {\r\n    this.step_count--;\r\n    var path = this.route.legs[0].steps[this.step_count].path;\r\n\r\n    for (var p in path){\r\n      if (path.hasOwnProperty(p)){\r\n        this.polyline.pop();\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.Route.prototype.forward = function() {\r\n  if (this.step_count < this.steps_length) {\r\n    var path = this.route.legs[0].steps[this.step_count].path;\r\n\r\n    for (var p in path){\r\n      if (path.hasOwnProperty(p)){\r\n        this.polyline.push(path[p]);\r\n      }\r\n    }\r\n    this.step_count++;\r\n  }\r\n};\r\n\r\nGMaps.prototype.checkGeofence = function(lat, lng, fence) {\r\n  return fence.containsLatLng(new google.maps.LatLng(lat, lng));\r\n};\r\n\r\nGMaps.prototype.checkMarkerGeofence = function(marker, outside_callback) {\r\n  if (marker.fences) {\r\n    for (var i = 0, fence; fence = marker.fences[i]; i++) {\r\n      var pos = marker.getPosition();\r\n      if (!this.checkGeofence(pos.lat(), pos.lng(), fence)) {\r\n        outside_callback(marker, fence);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.prototype.toImage = function(options) {\r\n  var options = options || {},\r\n      static_map_options = {};\r\n\r\n  static_map_options['size'] = options['size'] || [this.el.clientWidth, this.el.clientHeight];\r\n  static_map_options['lat'] = this.getCenter().lat();\r\n  static_map_options['lng'] = this.getCenter().lng();\r\n\r\n  if (this.markers.length > 0) {\r\n    static_map_options['markers'] = [];\r\n\r\n    for (var i = 0; i < this.markers.length; i++) {\r\n      static_map_options['markers'].push({\r\n        lat: this.markers[i].getPosition().lat(),\r\n        lng: this.markers[i].getPosition().lng()\r\n      });\r\n    }\r\n  }\r\n\r\n  if (this.polylines.length > 0) {\r\n    var polyline = this.polylines[0];\r\n\r\n    static_map_options['polyline'] = {};\r\n    static_map_options['polyline']['path'] = google.maps.geometry.encoding.encodePath(polyline.getPath());\r\n    static_map_options['polyline']['strokeColor'] = polyline.strokeColor\r\n    static_map_options['polyline']['strokeOpacity'] = polyline.strokeOpacity\r\n    static_map_options['polyline']['strokeWeight'] = polyline.strokeWeight\r\n  }\r\n\r\n  return GMaps.staticMapURL(static_map_options);\r\n};\r\n\r\nGMaps.staticMapURL = function(options){\r\n  var parameters = [],\r\n      data,\r\n      static_root = (location.protocol === 'file:' ? 'http:' : location.protocol ) + '//maps.googleapis.com/maps/api/staticmap';\r\n\r\n  if (options.url) {\r\n    static_root = options.url;\r\n    delete options.url;\r\n  }\r\n\r\n  static_root += '?';\r\n\r\n  var markers = options.markers;\r\n\r\n  delete options.markers;\r\n\r\n  if (!markers && options.marker) {\r\n    markers = [options.marker];\r\n    delete options.marker;\r\n  }\r\n\r\n  var styles = options.styles;\r\n\r\n  delete options.styles;\r\n\r\n  var polyline = options.polyline;\r\n  delete options.polyline;\r\n\r\n  /** Map options **/\r\n  if (options.center) {\r\n    parameters.push('center=' + options.center);\r\n    delete options.center;\r\n  }\r\n  else if (options.address) {\r\n    parameters.push('center=' + options.address);\r\n    delete options.address;\r\n  }\r\n  else if (options.lat) {\r\n    parameters.push(['center=', options.lat, ',', options.lng].join(''));\r\n    delete options.lat;\r\n    delete options.lng;\r\n  }\r\n  else if (options.visible) {\r\n    var visible = encodeURI(options.visible.join('|'));\r\n    parameters.push('visible=' + visible);\r\n  }\r\n\r\n  var size = options.size;\r\n  if (size) {\r\n    if (size.join) {\r\n      size = size.join('x');\r\n    }\r\n    delete options.size;\r\n  }\r\n  else {\r\n    size = '630x300';\r\n  }\r\n  parameters.push('size=' + size);\r\n\r\n  if (!options.zoom && options.zoom !== false) {\r\n    options.zoom = 15;\r\n  }\r\n\r\n  var sensor = options.hasOwnProperty('sensor') ? !!options.sensor : true;\r\n  delete options.sensor;\r\n  parameters.push('sensor=' + sensor);\r\n\r\n  for (var param in options) {\r\n    if (options.hasOwnProperty(param)) {\r\n      parameters.push(param + '=' + options[param]);\r\n    }\r\n  }\r\n\r\n  /** Markers **/\r\n  if (markers) {\r\n    var marker, loc;\r\n\r\n    for (var i = 0; data = markers[i]; i++) {\r\n      marker = [];\r\n\r\n      if (data.size && data.size !== 'normal') {\r\n        marker.push('size:' + data.size);\r\n        delete data.size;\r\n      }\r\n      else if (data.icon) {\r\n        marker.push('icon:' + encodeURI(data.icon));\r\n        delete data.icon;\r\n      }\r\n\r\n      if (data.color) {\r\n        marker.push('color:' + data.color.replace('#', '0x'));\r\n        delete data.color;\r\n      }\r\n\r\n      if (data.label) {\r\n        marker.push('label:' + data.label[0].toUpperCase());\r\n        delete data.label;\r\n      }\r\n\r\n      loc = (data.address ? data.address : data.lat + ',' + data.lng);\r\n      delete data.address;\r\n      delete data.lat;\r\n      delete data.lng;\r\n\r\n      for(var param in data){\r\n        if (data.hasOwnProperty(param)) {\r\n          marker.push(param + ':' + data[param]);\r\n        }\r\n      }\r\n\r\n      if (marker.length || i === 0) {\r\n        marker.push(loc);\r\n        marker = marker.join('|');\r\n        parameters.push('markers=' + encodeURI(marker));\r\n      }\r\n      // New marker without styles\r\n      else {\r\n        marker = parameters.pop() + encodeURI('|' + loc);\r\n        parameters.push(marker);\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Map Styles **/\r\n  if (styles) {\r\n    for (var i = 0; i < styles.length; i++) {\r\n      var styleRule = [];\r\n      if (styles[i].featureType){\r\n        styleRule.push('feature:' + styles[i].featureType.toLowerCase());\r\n      }\r\n\r\n      if (styles[i].elementType) {\r\n        styleRule.push('element:' + styles[i].elementType.toLowerCase());\r\n      }\r\n\r\n      for (var j = 0; j < styles[i].stylers.length; j++) {\r\n        for (var p in styles[i].stylers[j]) {\r\n          var ruleArg = styles[i].stylers[j][p];\r\n          if (p == 'hue' || p == 'color') {\r\n            ruleArg = '0x' + ruleArg.substring(1);\r\n          }\r\n          styleRule.push(p + ':' + ruleArg);\r\n        }\r\n      }\r\n\r\n      var rule = styleRule.join('|');\r\n      if (rule != '') {\r\n        parameters.push('style=' + rule);\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Polylines **/\r\n  function parseColor(color, opacity) {\r\n    if (color[0] === '#'){\r\n      color = color.replace('#', '0x');\r\n\r\n      if (opacity) {\r\n        opacity = parseFloat(opacity);\r\n        opacity = Math.min(1, Math.max(opacity, 0));\r\n        if (opacity === 0) {\r\n          return '0x00000000';\r\n        }\r\n        opacity = (opacity * 255).toString(16);\r\n        if (opacity.length === 1) {\r\n          opacity += opacity;\r\n        }\r\n\r\n        color = color.slice(0,8) + opacity;\r\n      }\r\n    }\r\n    return color;\r\n  }\r\n\r\n  if (polyline) {\r\n    data = polyline;\r\n    polyline = [];\r\n\r\n    if (data.strokeWeight) {\r\n      polyline.push('weight:' + parseInt(data.strokeWeight, 10));\r\n    }\r\n\r\n    if (data.strokeColor) {\r\n      var color = parseColor(data.strokeColor, data.strokeOpacity);\r\n      polyline.push('color:' + color);\r\n    }\r\n\r\n    if (data.fillColor) {\r\n      var fillcolor = parseColor(data.fillColor, data.fillOpacity);\r\n      polyline.push('fillcolor:' + fillcolor);\r\n    }\r\n\r\n    var path = data.path;\r\n    if (path.join) {\r\n      for (var j=0, pos; pos=path[j]; j++) {\r\n        polyline.push(pos.join(','));\r\n      }\r\n    }\r\n    else {\r\n      polyline.push('enc:' + path);\r\n    }\r\n\r\n    polyline = polyline.join('|');\r\n    parameters.push('path=' + encodeURI(polyline));\r\n  }\r\n\r\n  /** Retina support **/\r\n  var dpi = window.devicePixelRatio || 1;\r\n  parameters.push('scale=' + dpi);\r\n\r\n  parameters = parameters.join('&');\r\n  return static_root + parameters;\r\n};\r\n\r\nGMaps.prototype.addMapType = function(mapTypeId, options) {\r\n  if (options.hasOwnProperty(\"getTileUrl\") && typeof(options[\"getTileUrl\"]) == \"function\") {\r\n    options.tileSize = options.tileSize || new google.maps.Size(256, 256);\r\n\r\n    var mapType = new google.maps.ImageMapType(options);\r\n\r\n    this.map.mapTypes.set(mapTypeId, mapType);\r\n  }\r\n  else {\r\n    throw \"'getTileUrl' function required.\";\r\n  }\r\n};\r\n\r\nGMaps.prototype.addOverlayMapType = function(options) {\r\n  if (options.hasOwnProperty(\"getTile\") && typeof(options[\"getTile\"]) == \"function\") {\r\n    var overlayMapTypeIndex = options.index;\r\n\r\n    delete options.index;\r\n\r\n    this.map.overlayMapTypes.insertAt(overlayMapTypeIndex, options);\r\n  }\r\n  else {\r\n    throw \"'getTile' function required.\";\r\n  }\r\n};\r\n\r\nGMaps.prototype.removeOverlayMapType = function(overlayMapTypeIndex) {\r\n  this.map.overlayMapTypes.removeAt(overlayMapTypeIndex);\r\n};\r\n\r\nGMaps.prototype.addStyle = function(options) {\r\n  var styledMapType = new google.maps.StyledMapType(options.styles, { name: options.styledMapName });\r\n\r\n  this.map.mapTypes.set(options.mapTypeId, styledMapType);\r\n};\r\n\r\nGMaps.prototype.setStyle = function(mapTypeId) {\r\n  this.map.setMapTypeId(mapTypeId);\r\n};\r\n\r\nGMaps.prototype.createPanorama = function(streetview_options) {\r\n  if (!streetview_options.hasOwnProperty('lat') || !streetview_options.hasOwnProperty('lng')) {\r\n    streetview_options.lat = this.getCenter().lat();\r\n    streetview_options.lng = this.getCenter().lng();\r\n  }\r\n\r\n  this.panorama = GMaps.createPanorama(streetview_options);\r\n\r\n  this.map.setStreetView(this.panorama);\r\n\r\n  return this.panorama;\r\n};\r\n\r\nGMaps.createPanorama = function(options) {\r\n  var el = getElementById(options.el, options.context);\r\n\r\n  options.position = new google.maps.LatLng(options.lat, options.lng);\r\n\r\n  delete options.el;\r\n  delete options.context;\r\n  delete options.lat;\r\n  delete options.lng;\r\n\r\n  var streetview_events = ['closeclick', 'links_changed', 'pano_changed', 'position_changed', 'pov_changed', 'resize', 'visible_changed'],\r\n      streetview_options = extend_object({visible : true}, options);\r\n\r\n  for (var i = 0; i < streetview_events.length; i++) {\r\n    delete streetview_options[streetview_events[i]];\r\n  }\r\n\r\n  var panorama = new google.maps.StreetViewPanorama(el, streetview_options);\r\n\r\n  for (var i = 0; i < streetview_events.length; i++) {\r\n    (function(object, name) {\r\n      if (options[name]) {\r\n        google.maps.event.addListener(object, name, function(){\r\n          options[name].apply(this);\r\n        });\r\n      }\r\n    })(panorama, streetview_events[i]);\r\n  }\r\n\r\n  return panorama;\r\n};\r\n\r\nGMaps.prototype.on = function(event_name, handler) {\r\n  return GMaps.on(event_name, this, handler);\r\n};\r\n\r\nGMaps.prototype.off = function(event_name) {\r\n  GMaps.off(event_name, this);\r\n};\r\n\r\nGMaps.prototype.once = function(event_name, handler) {\r\n  return GMaps.once(event_name, this, handler);\r\n};\r\n\r\nGMaps.custom_events = ['marker_added', 'marker_removed', 'polyline_added', 'polyline_removed', 'polygon_added', 'polygon_removed', 'geolocated', 'geolocation_failed'];\r\n\r\nGMaps.on = function(event_name, object, handler) {\r\n  if (GMaps.custom_events.indexOf(event_name) == -1) {\r\n    if(object instanceof GMaps) object = object.map;\r\n    return google.maps.event.addListener(object, event_name, handler);\r\n  }\r\n  else {\r\n    var registered_event = {\r\n      handler : handler,\r\n      eventName : event_name\r\n    };\r\n\r\n    object.registered_events[event_name] = object.registered_events[event_name] || [];\r\n    object.registered_events[event_name].push(registered_event);\r\n\r\n    return registered_event;\r\n  }\r\n};\r\n\r\nGMaps.off = function(event_name, object) {\r\n  if (GMaps.custom_events.indexOf(event_name) == -1) {\r\n    if(object instanceof GMaps) object = object.map;\r\n    google.maps.event.clearListeners(object, event_name);\r\n  }\r\n  else {\r\n    object.registered_events[event_name] = [];\r\n  }\r\n};\r\n\r\nGMaps.once = function(event_name, object, handler) {\r\n  if (GMaps.custom_events.indexOf(event_name) == -1) {\r\n    if(object instanceof GMaps) object = object.map;\r\n    return google.maps.event.addListenerOnce(object, event_name, handler);\r\n  }\r\n};\r\n\r\nGMaps.fire = function(event_name, object, scope) {\r\n  if (GMaps.custom_events.indexOf(event_name) == -1) {\r\n    google.maps.event.trigger(object, event_name, Array.prototype.slice.apply(arguments).slice(2));\r\n  }\r\n  else {\r\n    if(event_name in scope.registered_events) {\r\n      var firing_events = scope.registered_events[event_name];\r\n\r\n      for(var i = 0; i < firing_events.length; i++) {\r\n        (function(handler, scope, object) {\r\n          handler.apply(scope, [object]);\r\n        })(firing_events[i]['handler'], scope, object);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.geolocate = function(options) {\r\n  var complete_callback = options.always || options.complete;\r\n\r\n  if (navigator.geolocation) {\r\n    navigator.geolocation.getCurrentPosition(function(position) {\r\n      options.success(position);\r\n\r\n      if (complete_callback) {\r\n        complete_callback();\r\n      }\r\n    }, function(error) {\r\n      options.error(error);\r\n\r\n      if (complete_callback) {\r\n        complete_callback();\r\n      }\r\n    }, options.options);\r\n  }\r\n  else {\r\n    options.not_supported();\r\n\r\n    if (complete_callback) {\r\n      complete_callback();\r\n    }\r\n  }\r\n};\r\n\r\nGMaps.geocode = function(options) {\r\n  this.geocoder = new google.maps.Geocoder();\r\n  var callback = options.callback;\r\n  if (options.hasOwnProperty('lat') && options.hasOwnProperty('lng')) {\r\n    options.latLng = new google.maps.LatLng(options.lat, options.lng);\r\n  }\r\n\r\n  delete options.lat;\r\n  delete options.lng;\r\n  delete options.callback;\r\n\r\n  this.geocoder.geocode(options, function(results, status) {\r\n    callback(results, status);\r\n  });\r\n};\r\n\r\nif (typeof window.google === 'object' && window.google.maps) {\r\n  //==========================\r\n  // Polygon containsLatLng\r\n  // https://github.com/tparkin/Google-Maps-Point-in-Polygon\r\n  // Poygon getBounds extension - google-maps-extensions\r\n  // http://code.google.com/p/google-maps-extensions/source/browse/google.maps.Polygon.getBounds.js\r\n  if (!google.maps.Polygon.prototype.getBounds) {\r\n    google.maps.Polygon.prototype.getBounds = function(latLng) {\r\n      var bounds = new google.maps.LatLngBounds();\r\n      var paths = this.getPaths();\r\n      var path;\r\n\r\n      for (var p = 0; p < paths.getLength(); p++) {\r\n        path = paths.getAt(p);\r\n        for (var i = 0; i < path.getLength(); i++) {\r\n          bounds.extend(path.getAt(i));\r\n        }\r\n      }\r\n\r\n      return bounds;\r\n    };\r\n  }\r\n\r\n  if (!google.maps.Polygon.prototype.containsLatLng) {\r\n    // Polygon containsLatLng - method to determine if a latLng is within a polygon\r\n    google.maps.Polygon.prototype.containsLatLng = function(latLng) {\r\n      // Exclude points outside of bounds as there is no way they are in the poly\r\n      var bounds = this.getBounds();\r\n\r\n      if (bounds !== null && !bounds.contains(latLng)) {\r\n        return false;\r\n      }\r\n\r\n      // Raycast point in polygon method\r\n      var inPoly = false;\r\n\r\n      var numPaths = this.getPaths().getLength();\r\n      for (var p = 0; p < numPaths; p++) {\r\n        var path = this.getPaths().getAt(p);\r\n        var numPoints = path.getLength();\r\n        var j = numPoints - 1;\r\n\r\n        for (var i = 0; i < numPoints; i++) {\r\n          var vertex1 = path.getAt(i);\r\n          var vertex2 = path.getAt(j);\r\n\r\n          if (vertex1.lng() < latLng.lng() && vertex2.lng() >= latLng.lng() || vertex2.lng() < latLng.lng() && vertex1.lng() >= latLng.lng()) {\r\n            if (vertex1.lat() + (latLng.lng() - vertex1.lng()) / (vertex2.lng() - vertex1.lng()) * (vertex2.lat() - vertex1.lat()) < latLng.lat()) {\r\n              inPoly = !inPoly;\r\n            }\r\n          }\r\n\r\n          j = i;\r\n        }\r\n      }\r\n\r\n      return inPoly;\r\n    };\r\n  }\r\n\r\n  if (!google.maps.Circle.prototype.containsLatLng) {\r\n    google.maps.Circle.prototype.containsLatLng = function(latLng) {\r\n      if (google.maps.geometry) {\r\n        return google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(), latLng) <= this.getRadius();\r\n      }\r\n      else {\r\n        return true;\r\n      }\r\n    };\r\n  }\r\n\r\n  google.maps.Rectangle.prototype.containsLatLng = function(latLng) {\r\n    return this.getBounds().contains(latLng);\r\n  };\r\n\r\n  google.maps.LatLngBounds.prototype.containsLatLng = function(latLng) {\r\n    return this.contains(latLng);\r\n  };\r\n\r\n  google.maps.Marker.prototype.setFences = function(fences) {\r\n    this.fences = fences;\r\n  };\r\n\r\n  google.maps.Marker.prototype.addFence = function(fence) {\r\n    this.fences.push(fence);\r\n  };\r\n\r\n  google.maps.Marker.prototype.getId = function() {\r\n    return this['__gm_id'];\r\n  };\r\n}\r\n\r\n//==========================\r\n// Array indexOf\r\n// https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf\r\nif (!Array.prototype.indexOf) {\r\n  Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {\r\n      \"use strict\";\r\n      if (this == null) {\r\n          throw new TypeError();\r\n      }\r\n      var t = Object(this);\r\n      var len = t.length >>> 0;\r\n      if (len === 0) {\r\n          return -1;\r\n      }\r\n      var n = 0;\r\n      if (arguments.length > 1) {\r\n          n = Number(arguments[1]);\r\n          if (n != n) { // shortcut for verifying if it's NaN\r\n              n = 0;\r\n          } else if (n != 0 && n != Infinity && n != -Infinity) {\r\n              n = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n          }\r\n      }\r\n      if (n >= len) {\r\n          return -1;\r\n      }\r\n      var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\r\n      for (; k < len; k++) {\r\n          if (k in t && t[k] === searchElement) {\r\n              return k;\r\n          }\r\n      }\r\n      return -1;\r\n  }\r\n}\r\n\r\nreturn GMaps;\r\n}));\r\n"]}